# =============================================================================
# Auth Service — Environment Configuration
# =============================================================================

# -----------------------------------------------------------------------------
# Application Settings
# -----------------------------------------------------------------------------
APP_NAME="Auth Service"
APP_ENV=local
APP_DEBUG=true
APP_TIMEZONE=UTC
APP_URL=http://localhost:8000
APP_LOCALE=ru
APP_FALLBACK_LOCALE=en
APP_FAKER_LOCALE=ru_RU

# Frontend URL для ссылок подтверждения email
FRONTEND_URL=http://localhost:3000

# Laravel Application Key (генерируется: php artisan key:generate)
APP_KEY=

# Maintenance Mode Driver
APP_MAINTENANCE_DRIVER=file
APP_MAINTENANCE_STORE=database

# -----------------------------------------------------------------------------
# Database Configuration (PostgreSQL)
# -----------------------------------------------------------------------------
DB_CONNECTION=pgsql
DB_HOST=postgres
DB_PORT=5432
DB_DATABASE=auth_service
DB_USERNAME=postgres
DB_PASSWORD=secret

# -----------------------------------------------------------------------------
# Redis Configuration
# -----------------------------------------------------------------------------
REDIS_CLIENT=predis
REDIS_HOST=redis
REDIS_PASSWORD=null
REDIS_PORT=6379
REDIS_DB=0

# Cache & Queue
CACHE_DRIVER=redis
CACHE_PREFIX=auth_cache
QUEUE_CONNECTION=redis

# Session & Broadcasting
SESSION_DRIVER=redis
SESSION_LIFETIME=120
BROADCAST_CONNECTION=redis

# -----------------------------------------------------------------------------
# JWT Authentication (Асимметричное шифрование - RSA)
# -----------------------------------------------------------------------------
# Алгоритм: RS256 (RSA + SHA256) — рекомендуется для production
# Для генерации ключей выполните: php artisan jwt:generate-keys
JWT_ALGO=RS256
JWT_PRIVATE_KEY=file:///var/www/html/storage/app/jwt/private.pem
JWT_PUBLIC_KEY=file:///var/www/html/storage/app/jwt/public.pem
# JWT_PASSPHRASE=  # Опционально, если приватный ключ защищён паролем

# Время жизни токенов (в минутах)
JWT_TTL=60                    # Access token: 1 час
JWT_REFRESH_TTL=20160         # Refresh token: 14 дней (20160 минут)

# JWT Blacklist
JWT_BLACKLIST_ENABLED=true
JWT_BLACKLIST_GRACE_PERIOD=0

# JWT Cache Settings
JWT_CACHE_STORE=redis
JWT_CACHE_PREFIX=auth:jwt
JWT_CACHE_MIN_TTL=5

# Leeway для синхронизации времени между серверами (в секундах)
JWT_LEEWAY=0

# -----------------------------------------------------------------------------
# JWT Authentication (Симметричное шифрование - HMAC) — АЛЬТЕРНАТИВА
# -----------------------------------------------------------------------------
# Если используете HS256 вместо RS256, раскомментируйте и сгенерируйте секрет
# Генерация: php artisan jwt:secret
# JWT_ALGO=HS256
# JWT_SECRET=

# ВАЖНО: При использовании RS256 закомментируйте JWT_SECRET
# При использовании HS256 закомментируйте JWT_PRIVATE_KEY и JWT_PUBLIC_KEY

# -----------------------------------------------------------------------------
# RabbitMQ Configuration
# -----------------------------------------------------------------------------
RABBITMQ_HOST=rabbitmq
RABBITMQ_PORT=5672
RABBITMQ_USER=guest
RABBITMQ_PASSWORD=guest
RABBITMQ_VHOST=/

# RabbitMQ Exchanges & Queues
RABBITMQ_EXCHANGE_USER_EVENTS=user.events
RABBITMQ_EXCHANGE_EMAIL_VERIFICATION=email.verification
RABBITMQ_QUEUE_USER_EVENTS=auth.user.events
RABBITMQ_QUEUE_EMAIL_VERIFICATION=auth.email.verification

# -----------------------------------------------------------------------------
# Logging Configuration
# -----------------------------------------------------------------------------
LOG_CHANNEL=stack
LOG_STACK=single
LOG_DEPRECATIONS_CHANNEL=null
LOG_LEVEL=debug

# -----------------------------------------------------------------------------
# Mail Configuration (если нужна прямая отправка, обычно через события)
# -----------------------------------------------------------------------------
MAIL_MAILER=log
MAIL_HOST=127.0.0.1
MAIL_PORT=2525
MAIL_USERNAME=null
MAIL_PASSWORD=null
MAIL_ENCRYPTION=null
MAIL_FROM_ADDRESS="noreply@skillup.com"
MAIL_FROM_NAME="${APP_NAME}"

# -----------------------------------------------------------------------------
# Security & Internal API
# -----------------------------------------------------------------------------
# Ключ для валидации запросов от API Gateway (опционально)
INTERNAL_JWT_VALIDATE_KEY=

# Allowed IPs для internal endpoints (разделяйте запятыми)
INTERNAL_ALLOWED_IPS=127.0.0.1,172.18.0.0/16

# -----------------------------------------------------------------------------
# File System
# -----------------------------------------------------------------------------
FILESYSTEM_DISK=local

# -----------------------------------------------------------------------------
# CORS Configuration
# -----------------------------------------------------------------------------
# Настраивается в config/cors.php

# -----------------------------------------------------------------------------
# Trusted Proxies
# -----------------------------------------------------------------------------
TRUSTED_PROXIES=*

# -----------------------------------------------------------------------------
# Development Tools
# -----------------------------------------------------------------------------
TELESCOPE_ENABLED=false
DEBUGBAR_ENABLED=false

# -----------------------------------------------------------------------------
# Testing
# -----------------------------------------------------------------------------
# При тестировании используйте отдельную БД
# DB_DATABASE=auth_service_test
